select m._Marker_key, m.symbol, m.name, m.chromosome, 
	o.offset, markerStatus = upper(substring(s.status, 1, 1)), markerType = t.name 
	into #markers 
	from MRK_Marker m, MRK_Offset o, MRK_Status s, MRK_Types t 
	where m._Organism_key = 1 
	and m._Marker_Status_key in (1,3) 
	and m._Marker_key = o._Marker_key 
	and o.source = 0 
	and m._Marker_Status_key = s._Marker_Status_key 
	and m._Marker_Type_key = t._Marker_Type_key 
	and exists (select 1 from ACC_Accession a where m._Marker_key = a._Object_key 
	and a._MGIType_key = 2 and a._LogicalDB_key in (9, 27) and a.prefixPart not in ("XP_", "NP_")

# MGI ids

select distinct m._Marker_key, a.accID 
      from #markers m, ACC_Accession a 
      where m._Marker_key = a._Object_key 
      and a._MGIType_key = 2 
      and a._LogicalDB_key = 1 
      and a.prefixPart = "MGI:" 
      and a.preferred = 1, auto

# GenBank ids

select distinct m._Marker_key, a.accID 
      from #markers m, ACC_Accession a 
      where m._Marker_key = a._Object_key 
      and a._MGIType_key = 2 
      and a._LogicalDB_key = 9, auto

# UniGene ids

select distinct m._Marker_key, a.accID 
      from #markers m, ACC_Accession a 
      where m._Marker_key = a._Object_key 
      and a._MGIType_key = 2 
      and a._LogicalDB_key = 23, auto

# RefSeq ids

select distinct m._Marker_key, a.accID 
      from #markers m, ACC_Accession a 
      where m._Marker_key = a._Object_key 
      and a._MGIType_key = 2 
      and a._LogicalDB_key = 27 
      and a.prefixPart not in ("XP_", "NP_"), auto

select * from #markers order by symbol